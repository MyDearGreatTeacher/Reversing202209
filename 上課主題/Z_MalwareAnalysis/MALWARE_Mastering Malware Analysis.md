# Mastering Malware Analysis


```
Mastering Malware Analysis
By Alexey Kleymenov , Amr Thabet

Section 1: Fundamental Theory
A Crash Course in CISC/RISC and Programming Basics


Section 2: Diving Deep into Windows Malware
Basic Static and Dynamic Analysis for x86/x64
Unpacking, Decryption, and Deobfuscation
Inspecting Process Injection and API Hooking
Bypassing Anti-Reverse Engineering Techniques
Understanding Kernel-Mode Rootkits

Section 3: Examining Cross-Platform Malware
Handling Exploits and Shellcode
Reversing Bytecode Languages: .NET, Java, and More
Scripts and Macros: Reversing, Deobfuscation, and Debugging

Section 4: Looking into IoT and Other Platforms
Dissecting Linux and IoT Malware
Introduction to macOS and iOS Threats
Analyzing Android Malware Samples
Other Books You May Enjoy
```

## Understanding Kernel-Mode Rootkits
```

Understanding Kernel-Mode Rootkits
Kernel mode versus user mode
Protection rings
Windows internals
The infrastructure of Windows
The execution path from user mode to kernel mode
Rootkits and device drivers
What is a rootkit?
Types of rootkits
What is a device driver?
Hooking mechanisms
SSDT hooking
Hooking the SYSENTER entry function
Modifying SSDT in an x86 environment
Modifying SSDT in an x64 environment
Hooking SSDT functions
IRP hooking
Devices and major functions
Attaching to a device
Modifying the IRP response and setting a completion routine
DKOM
The kernel objects—EPROCESS and ETHREAD
How do rootkits perform an object manipulation attack?
Process injection in kernel mode
Executing the inject code using APC queuing
KPP in x64 systems (PatchGuard)
Bypassing driver signature enforcement
Bypassing PatchGuard—the Turla example
Bypassing PatchGuard—GhostHook
Disabling PatchGuard using the Command Prompt
Static and dynamic analysis in kernel mode
Static analysis
Tools
Tips and tricks
Dynamic and behavioral analysis
Tools
Monitors
Rootkit detectors
Setting up a testing environment
Setting up the debugger
Stopping at the driver's entry point
Loading the driver
Restoring the debugging state
Summary
```
